
<!DOCTYPE html>
<!-- 
  ================================================================================
  L√öMEN - ARQUIVO DE ENTRADA HTML PRINCIPAL (index.html)
  Copyright (c) 2025 Paulo Gabriel de L. S.
  Todos os direitos reservados.
  
  Este √© o esqueleto da aplica√ß√£o Lumen. Ele define a estrutura fundamental
  da p√°gina, incluindo metadados, a √°rea de renderiza√ß√£o principal e os
  cont√™ineres para todos os modais da aplica√ß√£o. A l√≥gica e o conte√∫do
  din√¢mico s√£o injetados via JavaScript (index.tsx).
  ================================================================================
-->
<html lang="pt-BR" data-theme="dark">
<head>
    <!-- 
      CONFIGURA√á√ïES GLOBAIS DO DOCUMENTO
      A se√ß√£o <head> √© crucial para o correto funcionamento e SEO da p√°gina.
      Aqui definimos o conjunto de caracteres, a viewport para responsividade,
      o t√≠tulo da p√°gina e a folha de estilos principal.
    -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lumen 3.1: Painel de Gest√£o</title>
    <!-- 
      Copyright (c) 2025 Paulo Gabriel de L. S.
    -->
    <!-- A folha de estilos 'index.css' cont√©m toda a identidade visual do Lumen,
         incluindo o sistema de temas (dark/light) e a responsividade. -->
    <link rel="stylesheet" href="index.css">
    <!-- Folha de estilos dedicada APENAS √† impress√£o, garantindo fidelidade visual. -->
    <link rel="stylesheet" href="print.css" media="print">
<script type="importmap">
{
  "imports": {
    "vite": "https://esm.sh/vite@^7.3.1",
    "path": "https://esm.sh/path@^0.12.7",
    "url": "https://esm.sh/url@^0.11.4",
    "firebase/": "https://esm.sh/firebase@^12.8.0/"
  }
}
</script>
</head>
<body>
    <!-- 
      FUNDO ANIMADO
      Este elemento cria um fundo din√¢mico e visualmente agrad√°vel com formas
      geom√©tricas flutuantes, melhorando a est√©tica da aplica√ß√£o sem
      interferir na funcionalidade. √â posicionado de forma fixa e com z-index
      negativo para ficar atr√°s de todo o conte√∫do.
    -->
    <div class="animated-bg">
        <div class="triangle"></div>
        <div class="triangle"></div>
        <div class="triangle"></div>
        <div class="triangle"></div>
    </div>

    <!-- 
      CONT√äINER PRINCIPAL
      Engloba todo o conte√∫do vis√≠vel da aplica√ß√£o.
      IMPORTANTE: Inicia oculto para seguran√ßa at√© o login.
    -->
    <div class="main-container auth-hidden">
        <!-- 
          CABE√áALHO DA APLICA√á√ÉO
          Cont√©m a navega√ß√£o principal, a marca "Lumen", e os bot√µes de a√ß√£o
          globais como pesquisa e configura√ß√µes. Possui uma estrutura em grid
          para desktop e uma navega√ß√£o mobile separada para telas menores.
        -->
        <header class="main-header">
            <!-- Navega√ß√£o para Desktop -->
            <div class="desktop-header-grid">
                <div class="header-brand-section">
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                        <button id="lumen-brand-btn" data-view="dashboard" class="btn btn-large lumen-brand">
                            <span class="btn-text">Lumen <span style="font-size: 0.5em; opacity: 0.5; vertical-align: text-top; font-weight: 400;">3.1</span></span>
                        </button>
                        <!-- Cloud Status Icon -->
                        <div id="cloud-status-icon" title="Status da Nuvem" style="display: flex; align-items: center; padding: 0.5rem;">
                            <!-- Icon injected via JS -->
                        </div>
                    </div>
                    <span id="school-name">Microcamp Mogi das Cruzes</span>
                </div>
                <div class="header-left-middle">
                    <div class="btn-row"><button id="alunos-btn" data-view="alunos" class="btn btn-medium"><span class="btn-text">Gerenciamento de Alunos</span></button><button id="notas-btn" data-view="notas" class="btn btn-medium"><span class="btn-text">Notas e Avalia√ß√µes</span></button></div>
                    <div class="btn-row"><button id="aulas-extras-btn" data-view="aulasExtras" class="btn btn-medium"><span class="btn-text">Aulas Extras</span></button><button id="provas-btn" data-view="provas" class="btn btn-medium"><span class="btn-text">Provas e Tarefas</span></button></div>
                </div>
                <div class="header-center">
                    <button id="aula-dia-btn" data-view="aulaDia" class="btn btn-large"><span class="btn-text">Aula do Dia</span></button>
                </div>
                <div class="header-right-middle">
                    <div class="btn-row"><button id="calendario-btn" data-view="calendario" class="btn btn-medium"><span class="btn-text">Calend√°rio e Eventos</span></button><button id="relatorios-btn" data-view="relatorios" class="btn btn-medium"><span class="btn-text">Relat√≥rios e Estat√≠sticas</span></button></div>
                    <div class="btn-row"><button id="avisos-btn" data-view="avisos" class="btn btn-medium"><span class="btn-text">Avisos e Reuni√µes</span></button><button id="frequencia-btn" data-view="frequencia" class="btn btn-medium"><span class="btn-text">Registro de Frequ√™ncia</span></button></div>
                </div>
                <div class="header-right">
                    <div class="top-icon-buttons">
                        <button id="search-btn" class="btn btn-icon" aria-label="Pesquisar">
                            <svg class="btn-icon-svg" viewBox="0 0 24 24" fill="currentColor"><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg>
                        </button>
                        <button id="settings-btn" class="btn btn-icon" aria-label="Configura√ß√µes">
                            <svg class="btn-icon-svg" viewBox="0 0 24 24" fill="currentColor"><path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.69-1.62-0.92L14.4,2.23c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.44,0.17-0.48,0.41L9.18,4.59C8.59,4.82,8.06,5.14,7.56,5.51L5.17,4.55C4.95,4.48,4.7,4.55,4.59,4.75L2.67,8.07 C2.55,8.27,2.6,8.54,2.77,8.68l2.03,1.58C4.75,10.6,4.73,10.91,4.73,11.23c0,0.32,0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.69,1.62,0.92l0.43,2.36 c0.04,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44,0.17,0.48,0.41l0.43-2.36c0.59-0.23,1.12-0.54,1.62-0.92l2.39,0.96 c0.22,0.08,0.47,0.01,0.59-0.22l1.92-3.32C21.36,13.35,21.31,13.08,21.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"></path></svg>
                        </button>
                        <button id="theme-toggle" class="btn btn-icon" aria-label="Alternar tema"></button>
                    </div>
                    <button id="recursos-btn" data-view="recursos" class="btn btn-medium"><span class="btn-text">Biblioteca e Recursos Did√°ticos</span></button>
                </div>
            </div>

            <!-- Navega√ß√£o para Dispositivos M√≥veis (ativada via CSS media queries) -->
            <nav class="mobile-nav">
                <button class="mobile-header-title" data-view="dashboard">Lumen <span style="font-size: 0.5em; opacity: 0.5; vertical-align: text-top; font-weight: 400;">3.1</span></button>
                <div class="hamburger-menu">
                    <div class="bar bar1"></div>
                    <div class="bar bar2"></div>
                    <div class="bar bar3"></div>
                </div>
                <div class="mobile-nav-menu">
                </div>
            </nav>
        </header>
        
        <!-- 
          CONTE√öDO PRINCIPAL (VIEWS)
          Esta se√ß√£o <main> serve como um cont√™iner para as diferentes "telas"
          (views) da aplica√ß√£o. Apenas uma view √© vis√≠vel por vez, e a troca
          entre elas √© controlada pelo JavaScript, que adiciona/remove a classe 'visible'.
        -->
        <main>
            <!-- Cada div .content-view representa uma tela diferente da aplica√ß√£o. -->
            <div id="dashboard-content" class="content-view">
                <h1 class="view-title">Bem-vindo ao Lumen</h1>
                <p>Selecione uma op√ß√£o no menu acima para come√ßar.</p>
            </div>
            <div id="alunos-content" class="content-view">
            </div>
            <div id="alunos-excluidos-content" class="content-view">
            </div>
            <div id="notas-content" class="content-view">
            </div>
            <div id="salas-finalizadas-content" class="content-view">
            </div>
            <div id="aulas-extras-content" class="content-view">
            </div>
            <div id="avisos-content" class="content-view">
                <div class="view-header">
                    <h1 class="view-title">Quadro de Avisos e Reuni√µes</h1>
                    <button id="add-aviso-btn" class="btn btn-large btn-primary">
                        <svg class="btn-icon-svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                        <span class="btn-text">Adicionar Aviso</span>
                    </button>
                </div>
                <div id="avisos-list-container" class="avisos-list">
                </div>
            </div>
            <div id="recursos-content" class="content-view">
                <div class="view-header">
                    <h1 class="view-title">Biblioteca e Recursos Did√°ticos</h1>
                    <button id="add-recurso-btn" class="btn btn-large btn-primary">
                        <svg class="btn-icon-svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                        <span class="btn-text">Adicionar Material</span>
                    </button>
                </div>
                <div class="view-filters">
                    <div class="filter-group">
                        <label for="filter-assunto">Filtrar por Assunto</label>
                        <input type="text" id="filter-assunto" class="filter-input" placeholder="Ex: To Be Verb">
                    </div>
                     <div class="filter-group">
                        <label for="filter-livro">Filtrar por Livro</label>
                        <input type="text" id="filter-livro" class="filter-input" placeholder="Ex: Book 1">
                    </div>
                    <div class="filter-group">
                        <label for="filter-tipo">Filtrar por Tipo</label>
                        <select id="filter-tipo" class="filter-input">
                            <option value="">Todos os Tipos</option>
                            <option value="Exerc√≠cio Impresso">Exerc√≠cio Impresso</option>
                            <option value="Kahoot">Kahoot</option>
                            <option value="Google Slides">Google Slides</option>
                            <option value="V√≠deo">V√≠deo</option>
                            <option value="Outros">Outros</option>
                        </select>
                    </div>
                </div>
                <div class="table-container">
                    <table class="data-table" id="recursos-table">
                        <thead>
                            <tr>
                                <th data-sort="livro">Nome do Livro</th>
                                <th data-sort="pagina">P√°gina</th>
                                <th data-sort="tipo">Tipo do Material</th>
                                <th data-sort="assunto">Assunto</th>
                                <th data-sort="link">Link</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="recursos-tbody">
                        </tbody>
                    </table>
                </div>
                <div id="recursos-cards-container" class="cards-container">
                </div>
                 <div id="recursos-empty-state" class="empty-state" style="display: none;">
                    <p>Nenhum material did√°tico encontrado.</p>
                    <p>Clique em "Adicionar Material" para criar o primeiro.</p>
                </div>
            </div>
            <div id="provas-content" class="content-view">
                <div class="view-header">
                    <h1 class="view-title">Provas e Tarefas</h1>
                    <button id="add-prova-btn" class="btn btn-large btn-primary">
                        <svg class="btn-icon-svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                        <span class="btn-text">Adicionar Prova</span>
                    </button>
                </div>
                <div class="btn-row" id="provas-category-nav" style="margin-bottom: 1.5rem; justify-content: flex-start;">
                    <button class="btn active" data-category="new"><span class="btn-text">New Books</span></button>
                    <button class="btn" data-category="old"><span class="btn-text">Old Books</span></button>
                </div>
                <div class="view-filters">
                    <div class="filter-group">
                        <label for="filter-prova-livro">Filtrar por Livro</label>
                        <input type="text" id="filter-prova-livro" class="filter-input" placeholder="Ex: Book 1">
                    </div>
                     <div class="filter-group">
                        <label for="filter-prova-temas">Filtrar por Tema</label>
                        <input type="text" id="filter-prova-temas" class="filter-input" placeholder="Ex: Plural">
                    </div>
                    <div class="filter-group">
                        <label for="filter-prova-tipo">Filtrar por Tipo</label>
                        <select id="filter-prova-tipo" class="filter-input">
                           <option value="">Todos os Tipos</option>
                           <option value="Prova Normal">Prova Normal</option>
                           <option value="Prova Conjunta">Prova Conjunta</option>
                           <option value="Outros">Outros</option>
                        </select>
                    </div>
                </div>
                <div class="table-container">
                    <table class="data-table" id="provas-table">
                        <thead>
                            <tr>
                                <th data-sort="livro">Nome do Livro</th>
                                <th data-sort="tipo">Tipo</th>
                                <th data-sort="temas">Temas Aplicados</th>
                                <th data-sort="linkEscrita">Prova Escrita</th>
                                <th data-sort="linkOral">Prova Oral</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="provas-tbody"></tbody>
                    </table>
                </div>
                <div id="provas-cards-container" class="cards-container"></div>
                 <div id="provas-empty-state" class="empty-state" style="display: none;">
                    <p>Nenhuma prova encontrada para esta categoria.</p>
                    <p>Clique em "Adicionar Prova" para criar a primeira.</p>
                </div>
            </div>
            
            <div id="aula-dia-content" class="content-view">
                <div class="view-header">
                    <h1 id="aula-dia-view-title" class="view-title">Aula do Dia</h1>
                    <div class="btn-row">
                        <button id="add-ferias-btn" class="btn btn-large" style="background: linear-gradient(135deg, #f6d365 0%, #fda085 100%); color: #333; border: none;">
                            <svg class="btn-icon-svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"></path><path d="M12 5v14"></path></svg>
                            <span class="btn-text">Registrar F√©rias</span>
                        </button>
                        <button id="add-aula-btn" class="btn btn-large btn-primary">
                            <svg class="btn-icon-svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                            <span class="btn-text">Planejar Aula</span>
                        </button>
                        <button id="add-freelance-aula-btn" class="btn btn-large">
                            <svg class="btn-icon-svg" fill="currentColor" viewBox="0 0 24 24" width="20" height="20"><path d="M20 6h-4V4c0-1.11-.89-2-2-2h-4c-1.11 0-2 .89-2 2v2H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-6 0h-4V4h4v2z"></path></svg>
                            <span class="btn-text">Aula Horista Avulsa</span>
                        </button>
                        <button id="aulas-arquivadas-btn" data-view="aulasArquivadas" class="btn btn-large">
                             <svg class="btn-icon-svg" viewBox="0 0 24 24" fill="currentColor" width="20" height="20"><path d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zm0-8h14V7H7v2z"></path></svg>
                            <span class="btn-text">Aulas Arquivadas</span>
                        </button>
                    </div>
                </div>
                <div id="aula-dia-list-container" class="aula-dia-list-container">
                </div>
                <div id="aulas-empty-state" class="empty-state" style="display: none;">
                    <p>Nenhuma aula planejada para este m√™s.</p>
                    <p>Clique em "Planejar Aula" para come√ßar.</p>
                </div>
            </div>

            <div id="aulas-arquivadas-content" class="content-view">
                <div class="view-header">
                     <button id="voltar-calendario-btn" data-view="aulaDia" class="btn btn-large">
                        <svg class="btn-icon-svg" viewBox="0 0 24 24" fill="currentColor" width="20" height="20"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"></path></svg>
                        <span class="btn-text">Voltar para o M√™s Atual</span>
                    </button>
                    <h1 id="aulas-arquivadas-view-title" class="view-title">Aulas Arquivadas</h1>
                </div>
                 <div class="view-filters">
                    <div class="filter-group" style="flex-grow: 2;">
                        <label for="archive-month-select">Selecionar M√™s</label>
                        <select id="archive-month-select" class="filter-input">
                        </select>
                    </div>
                </div>
                <div id="aulas-arquivadas-list-container" class="aula-dia-list-container">
                </div>
                <div id="aulas-arquivadas-empty-state" class="empty-state" style="display: none;">
                    <p>Nenhuma aula encontrada para o m√™s selecionado.</p>
                </div>
            </div>
            
            <div id="frequencia-content" class="content-view">
                <div class="view-header">
                    <h1 class="view-title">Registro de Frequ√™ncia</h1>
                    <div class="btn-row">
                        <button id="frequencia-toggle-visibility-btn" class="btn btn-icon" aria-label="Mostrar/Ocultar Valores">
                        </button>
                    </div>
                </div>
                <div id="frequencia-content-body" class="frequencia-grid">
                </div>
            </div>

            <div id="calendario-content" class="content-view">
            </div>

            <div id="relatorios-content" class="content-view">
            </div>
        </main>
        
        <!-- 
          BARRA DE A√á√ïES INFERIOR
          Oferece acesso r√°pido a funcionalidades globais de importa√ß√£o e
          exporta√ß√£o de dados, permanecendo em uma posi√ß√£o de destaque no
          final da √°rea de conte√∫do.
        -->
        <div class="bottom-action-bar">
            <!-- Grupo Esquerda: Import/Export -->
            <div class="data-actions-group" style="display: flex; gap: 1rem;">
                 <button id="import-btn" class="btn btn-large">
                    <svg class="btn-icon-svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line></svg>
                    <span class="btn-text">Importar JSON</span>
                    <div class="spinner"></div>
                 </button>
                 <button id="export-btn" class="btn btn-large">
                    <svg class="btn-icon-svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
                    <span class="btn-text">Exportar JSON</span>
                 </button>
            </div>

            <!-- Grupo Direita: Informa√ß√µes do Usu√°rio e Status -->
            <div class="user-info-bar">
                <span id="cloud-save-status" class="status-text"></span>
                <span id="current-user-email" class="user-email-display">N√£o logado</span>
                <button id="footer-logout-btn" class="btn btn-medium logout-btn-footer">
                    <svg class="btn-icon-svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>
                    <span class="btn-text">Sair</span>
                </button>
            </div>
        </div>
    </div>
    
    <!-- Input oculto para acionar a sele√ß√£o de arquivo para importa√ß√£o. -->
    <input type="file" id="import-file-input" accept=".json" style="display: none;">

    <!-- 
      SOBREPOSI√á√ÉO DE ARRASTAR E SOLTAR (DRAG & DROP)
      Uma interface visual que aparece quando o usu√°rio arrasta um arquivo sobre
      a janela do navegador, facilitando a importa√ß√£o de dados.
    -->
    <div id="drag-drop-overlay">
        <div class="drag-drop-content">
            <svg class="drag-drop-icon" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line></svg>
            <h2>Arraste o arquivo JSON aqui</h2>
            <p>Solte para iniciar a importa√ß√£o</p>
        </div>
    </div>

    <!-- 
      TELA DE LOGIN / BLOQUEIO (LOCK SCREEN)
      Esta interface sobrep√µe todo o conte√∫do at√© que o usu√°rio seja autenticado.
      Utiliza glassmorphism e design limpo para uma boa primeira impress√£o.
    -->
    <div id="login-screen">
        <div class="login-card">
            <h1 class="login-title">Bem-vindo de volta</h1>
            <p class="login-subtitle">Acesso Restrito ao Sistema Lumen</p>
            <form id="login-form" class="login-form">
                <div class="form-group">
                    <label for="login-email" style="text-align: left;">E-mail</label>
                    <input type="email" id="login-email" required autocomplete="username" placeholder="exemplo@lumen.com">
                </div>
                <div class="form-group">
                    <label for="login-password" style="text-align: left;">Senha</label>
                    <div style="position: relative;">
                        <input type="password" id="login-password" required autocomplete="current-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" style="padding-right: 40px;">
                        <button type="button" id="password-toggle-btn" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: none; border: none; color: var(--text-secondary); cursor: pointer; padding: 0;">
                            <svg class="btn-icon-svg" viewBox="0 0 24 24" width="20" height="20" fill="currentColor"><path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5C21.27 7.61 17 4.5 12 4.5zm0 12c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                        </button>
                    </div>
                </div>
                <!-- Campo de confirma√ß√£o de senha (Apenas para cadastro) -->
                <div class="form-group" id="signup-confirm-group" style="display: none;">
                    <label for="signup-confirm-password" style="text-align: left;">Confirmar Senha</label>
                    <input type="password" id="signup-confirm-password" placeholder="Repita a senha">
                </div>
                
                <!-- Checkbox Lembrar de Mim (Toggle Switch) -->
                <div class="form-group" id="remember-me-group" style="display: flex; flex-direction: row; align-items: center; justify-content: space-between; margin-bottom: 1.5rem;">
                    <label for="remember-me" style="margin-bottom: 0; cursor: pointer; color: var(--text-secondary); font-size: 0.9rem;">Manter conectado</label>
                    <label class="toggle-switch" for="remember-me">
                        <input type="checkbox" id="remember-me" checked>
                        <span class="slider round"></span>
                    </label>
                </div>

                <button type="submit" id="login-btn" class="btn btn-primary btn-large" style="margin-top: 0.5rem; width: 100%;">
                    <span class="btn-text">Entrar</span>
                    <div class="spinner"></div>
                </button>
            </form>
            <div style="margin-top: 1.5rem; text-align: center; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 1rem;">
                <p style="color: var(--text-secondary); font-size: 0.9rem;">
                    <a href="#" id="toggle-auth" style="color: var(--primary-blue); text-decoration: none; font-weight: 500;">N√£o tem conta? Cadastre-se</a>
                </p>
            </div>
        </div>
    </div>

    <!-- Novo Modal de Confirma√ß√£o de Logout (substitui o window.confirm) -->
    <div id="logout-confirm-modal" class="modal-backdrop">
        <div class="modal-content" style="max-width: 400px; text-align: center;">
            <h2 class="view-title">Sair do Sistema?</h2>
            <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">Voc√™ ter√° que fazer login novamente para acessar seus dados.</p>
            <div class="modal-actions" style="justify-content: center;">
                <button type="button" id="cancel-logout-btn" class="btn">Cancelar</button>
                <button type="button" id="confirm-logout-btn" class="btn btn-primary" style="background-color: var(--error-color);">
                    <span class="btn-text">Sair</span>
                </button>
            </div>
        </div>
    </div>


    <!-- 
      ================================================================================
      SE√á√ÉO DE MODAIS
      
      Todos os modais da aplica√ß√£o s√£o pr√©-definidos no HTML, mas permanecem
      ocultos por padr√£o. O JavaScript controla sua visibilidade, preenche
      seus formul√°rios com os dados necess√°rios e gerencia suas intera√ß√µes.
      Esta abordagem melhora a performance ao evitar a cria√ß√£o e destrui√ß√£o
      constante de elementos no DOM.
      ================================================================================
    -->
    <div id="aviso-modal" class="modal-backdrop">
        <div class="modal-content">
            <h2 id="modal-title" class="view-title">Adicionar Novo Aviso</h2>
            <form id="aviso-form">
                <input type="hidden" id="aviso-id">
                <div class="form-group">
                    <label for="aviso-date">Data</label>
                    <input type="date" id="aviso-date" required>
                </div>
                <div class="form-group">
                    <label for="aviso-notes">T√≠tulo Curto</label>
                    <input type="text" id="aviso-notes" placeholder="Ex: Reuni√£o Geral - 13h" required>
                </div>
                <div class="form-group">
                    <label for="aviso-details">Detalhes</label>
                    <textarea id="aviso-details" placeholder="Descreva aqui os detalhes completos do aviso ou da pauta da reuni√£o..." required></textarea>
                </div>
                <div class="modal-actions">
                    <button type="button" id="cancel-btn" class="btn">Cancelar</button>
                    <button type="submit" id="save-btn" class="btn btn-primary">
                        <span class="btn-text">Salvar</span>
                        <div class="spinner"></div>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="recurso-modal" class="modal-backdrop">
        <div class="modal-content" style="max-width: 600px;">
            <h2 id="recurso-modal-title" class="view-title">Adicionar Material</h2>
            <form id="recurso-form">
                <input type="hidden" id="recurso-id">
                <div class="form-group">
                    <label for="recurso-livro">Nome do Livro</label>
                    <input type="text" id="recurso-livro" placeholder="Ex: Book 1" required>
                </div>
                <div class="form-group">
                    <label for="recurso-pagina">P√°gina do Livro</label>
                    <input type="number" id="recurso-pagina" placeholder="Ex: 25" required>
                </div>
                <div class="form-group">
                    <label for="recurso-tipo">Tipo do Material</label>
                    <select id="recurso-tipo" required>
                        <option value="Exerc√≠cio Impresso">Exerc√≠cio Impresso</option>
                        <option value="Kahoot">Kahoot</option>
                        <option value="Google Slides">Google Slides</option>
                        <option value="V√≠deo">V√≠deo</option>
                        <option value="Outros">Outros</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="recurso-assunto">Assunto</label>
                    <input type="text" id="recurso-assunto" placeholder="Ex: To Be Verb" required>
                </div>
                <div class="form-group">
                    <label for="recurso-link">Link do Material (opcional)</label>
                    <input type="url" id="recurso-link" placeholder="https://kahoot.it/...">
                </div>
                <div class="modal-actions">
                    <button type="button" id="recurso-cancel-btn" class="btn">Cancelar</button>
                    <button type="submit" id="recurso-save-btn" class="btn btn-primary">
                        <span class="btn-text">Salvar</span>
                        <div class="spinner"></div>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="prova-modal" class="modal-backdrop">
        <div class="modal-content" style="max-width: 600px;">
            <h2 id="prova-modal-title" class="view-title">Adicionar Nova Prova</h2>
            <form id="prova-form">
                <input type="hidden" id="prova-id">
                 <div class="form-group">
                    <label for="prova-category">Categoria do Livro</label>
                    <select id="prova-category" required>
                        <option value="new">New Book</option>
                        <option value="old">Old Book</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="prova-livro">Nome do Livro</label>
                    <input type="text" id="prova-livro" placeholder="Ex: Book 3" required>
                </div>
                <div class="form-group">
                    <label for="prova-tipo">Tipo da Prova</label>
                    <select id="prova-tipo" required>
                        <option value="Prova Normal">Prova Normal</option>
                        <option value="Prova Conjunta">Prova Conjunta</option>
                        <option value="Outros">Outros</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="prova-temas">Temas Aplicados</label>
                    <textarea id="prova-temas" placeholder="Ex: Plural; Name; Family; Personality..." required></textarea>
                </div>
                <div class="form-group">
                    <label for="prova-linkEscrita">Link da Prova Escrita (opcional)</label>
                    <input type="url" id="prova-linkEscrita" placeholder="https://forms.gle/...">
                </div>
                 <div class="form-group">
                    <label for="prova-linkOral">Link da Prova Oral (opcional)</label>
                    <input type="url" id="prova-linkOral" placeholder="https://docs.google.com/document/...">
                </div>
                <div class="modal-actions">
                    <button type="button" id="prova-cancel-btn" class="btn">Cancelar</button>
                    <button type="submit" id="prova-save-btn" class="btn btn-primary">
                        <span class="btn-text">Salvar</span>
                        <div class="spinner"></div>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="ferias-modal" class="modal-backdrop">
        <div class="modal-content" style="max-width: 400px; text-align: center;">
            <h2 class="view-title">Registrar F√©rias! üéâ</h2>
            <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">Selecione o per√≠odo para registrar f√©rias no sistema.</p>
            <form id="ferias-form">
                <div class="form-group">
                    <label for="ferias-start-date">In√≠cio das F√©rias</label>
                    <input type="date" id="ferias-start-date" required>
                </div>
                <div class="form-group">
                    <label for="ferias-end-date">Fim das F√©rias</label>
                    <input type="date" id="ferias-end-date" required>
                </div>
                <div class="modal-actions" style="justify-content: center;">
                    <button type="button" id="ferias-cancel-btn" class="btn">Cancelar</button>
                    <button type="submit" id="ferias-save-btn" class="btn btn-primary">
                        <span class="btn-text">Confirmar</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="aula-dia-modal" class="modal-backdrop">
        <div class="modal-content">
            <h2 id="aula-dia-modal-title" class="view-title">Planejar Nova Aula</h2>
            <form id="aula-dia-form">
                <input type="hidden" id="aula-dia-id">
                
                <div class="form-group">
                    <label for="aula-dia-date">Data</label>
                    <input type="date" id="aula-dia-date" required>
                </div>

                <div class="form-group full-width" id="sem-aula-toggle-group">
                    <label>
                        <input type="checkbox" id="aula-dia-sem-aula-check">
                        Marcar este dia como "Sem Aula" (Feriado, Evento, etc.)
                    </label>
                </div>

                <div id="sem-aula-details-group" class="form-grid" style="display: none;">
                    <div class="form-group">
                        <label for="sem-aula-tipo">Tipo de Evento</label>
                        <select id="sem-aula-tipo">
                            <option value="Feriado">Feriado</option>
                            <option value="Evento">Evento Escolar</option>
                            <option value="Outros">Outros</option>
                        </select>
                    </div>
                    <div class="form-group" style="grid-column: 2 / -1;">
                        <label for="sem-aula-descricao">Descri√ß√£o</label>
                        <input type="text" id="sem-aula-descricao" placeholder="Ex: Feriado de Corpus Christi">
                    </div>
                </div>
                
                <div id="aula-principal-form-grid">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="aula-dia-turma">Turma</label>
                            <input type="text" id="aula-dia-turma" list="turmas-list" placeholder="Ex: SQ18h" autocomplete="off">
                            <datalist id="turmas-list">
                            </datalist>
                        </div>
                        <div class="form-group">
                            <label for="aula-dia-linguagem">Idioma</label>
                            <select id="aula-dia-linguagem">
                                <option value="PT">Portugu√™s (PT)</option>
                                <option value="EN">Ingl√™s (EN)</option>
                            </select>
                        </div>
                        <div class="form-group full-width">
                            <label for="aula-dia-tema">Tema Principal da Aula</label>
                            <input type="text" id="aula-dia-tema" placeholder="Ex: Verb To Be Review">
                        </div>
                        
                        <div class="form-group full-width" style="border-top: 1px solid var(--border-color); padding-top: 1rem;">
                            <label for="aula-dia-onde-parou">Onde Parou (Aula Anterior)</label>
                             <div class="form-grid" style="gap: 0.5rem 1rem;">
                                <select id="aula-dia-livro-parou" style="grid-column: 1 / 2;">
                                </select>
                                <textarea id="aula-dia-onde-parou" placeholder="Conte√∫do da aula anterior..." style="grid-column: 2 / -1; min-height: 80px;"></textarea>
                            </div>
                        </div>

                        <div class="form-group full-width">
                            <label for="aula-dia-hoje">Planejamento da Aula de Hoje (para Chamada)</label>
                             <div class="form-grid" style="gap: 0.5rem 1rem;">
                                 <select id="aula-dia-livro-hoje" style="grid-column: 1 / 2;" required>
                                 </select>
                                <textarea id="aula-dia-hoje" placeholder="Descreva as atividades, p√°ginas e exerc√≠cios..." style="grid-column: 2 / -1;"></textarea>
                            </div>
                        </div>
                         <div class="form-group full-width">
                            <label for="aula-dia-seguinte">Conte√∫do para a Pr√≥xima Aula (Opcional)</label>
                            <textarea id="aula-dia-seguinte" placeholder="Cole aqui o conte√∫do que n√£o deu tempo de aplicar..." style="min-height: 80px;"></textarea>
                        </div>

                        <div class="form-group full-width">
                            <label for="aula-dia-anotacoes">Anota√ß√µes (Opcional)</label>
                            <textarea id="aula-dia-anotacoes" placeholder="Observa√ß√µes sobre a turma, preparativos, etc." style="min-height: 80px;"></textarea>
                        </div>
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" id="aula-dia-cancel-btn" class="btn">Cancelar</button>
                    <button type="submit" id="aula-dia-save-btn" class="btn btn-primary">
                        <span class="btn-text">Salvar</span>
                        <div class="spinner"></div>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="freelance-aula-modal" class="modal-backdrop">
        <div class="modal-content">
            <h2 id="freelance-aula-modal-title" class="view-title">Registrar Aula Horista Avulsa</h2>
            <form id="freelance-aula-form">
                <input type="hidden" id="freelance-aula-id">
                <div class="form-grid" style="grid-template-columns: 1fr 1fr;">
                    <div class="form-group">
                        <label for="freelance-aula-date">Data</label>
                        <input type="date" id="freelance-aula-date" required>
                    </div>
                    <div class="form-group">
                        <label for="freelance-aula-duracao">Dura√ß√£o (horas)</label>
                        <input type="number" id="freelance-aula-duracao" min="0.5" step="0.5" value="1.5" required>
                    </div>
                    <div class="form-group">
                        <label for="freelance-aula-turma">Turma / Refer√™ncia</label>
                        <input type="text" id="freelance-aula-turma" placeholder="Ex: Refor√ßo Maria" required>
                    </div>
                    <div class="form-group">
                        <label for="freelance-aula-escola">Escola (Opcional)</label>
                        <input type="text" id="freelance-aula-escola" placeholder="Ex: Col√©gio XYZ">
                    </div>
                </div>
                <div class="form-group">
                    <label for="freelance-aula-conteudo">Conte√∫do Aplicado</label>
                    <textarea id="freelance-aula-conteudo" placeholder="Descreva as atividades e t√≥picos abordados..." required></textarea>
                </div>
                <div class="form-group">
                    <label for="freelance-aula-anotacoes">Anota√ß√µes (Opcional)</label>
                    <textarea id="freelance-aula-anotacoes" placeholder="Observa√ß√µes sobre a aula, desempenho, etc." style="min-height: 80px;"></textarea>
                </div>
                <div class="modal-actions">
                    <button type="button" id="freelance-aula-cancel-btn" class="btn">Cancelar</button>
                    <button type="submit" id="freelance-aula-save-btn" class="btn btn-primary">
                        <span class="btn-text">Salvar Aula</span>
                        <div class="spinner"></div>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="calendario-modal" class="modal-backdrop">
        <div class="modal-content">
            <h2 id="calendario-modal-title" class="view-title">Adicionar Evento</h2>
            <form id="calendario-form">
                <input type="hidden" id="calendario-evento-id">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="calendario-evento-date">Data</label>
                        <input type="date" id="calendario-evento-date" required>
                    </div>
                    <div class="form-group">
                        <label for="calendario-evento-tipo">Tipo</label>
                        <select id="calendario-evento-tipo" required>
                            <option value="evento">Evento Escolar</option>
                            <option value="feriado">Feriado</option>
                            <option value="sem-aula">Dia Sem Aula (Ponto Facultativo, etc)</option>
                            <option value="lembrete">Lembrete Pessoal</option>
                        </select>
                    </div>
                    <div class="form-group full-width">
                        <label for="calendario-evento-title">T√≠tulo</label>
                        <input type="text" id="calendario-evento-title" placeholder="Ex: Festa Junina" required>
                    </div>
                    <div class="form-group full-width">
                        <label for="calendario-evento-description">Descri√ß√£o (Opcional)</label>
                        <textarea id="calendario-evento-description" placeholder="Detalhes sobre o evento..."></textarea>
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" id="calendario-cancel-btn" class="btn">Cancelar</button>
                    <button type="submit" id="calendario-save-btn" class="btn btn-primary">
                        <span class="btn-text">Salvar</span>
                        <div class="spinner"></div>
                    </button>
                </div>
            </form>
        </div>
    </div>


    <div id="delete-confirm-modal" class="modal-backdrop">
        <div class="modal-content" style="max-width: 500px;">
            <h2 class="view-title">Confirmar Exclus√£o</h2>
            <p id="delete-confirm-message">Tem certeza que deseja excluir este item? Esta a√ß√£o n√£o pode ser desfeita.</p>
            <div class="modal-actions">
                <button type="button" id="cancel-delete-btn" class="btn">Cancelar</button>
                <button type="button" id="confirm-delete-btn" class="btn btn-primary" style="background-color: var(--error-color); border-color: transparent;">
                    <span class="btn-text">Excluir</span>
                    <div class="spinner"></div>
                </button>
            </div>
        </div>
    </div>

    <div id="import-confirm-modal" class="modal-backdrop">
        <div class="modal-content" style="max-width: 500px;">
            <h2 class="view-title">Confirmar Importa√ß√£o</h2>
            <p>Tem certeza de que deseja importar este arquivo? Todos os dados atuais ser√£o substitu√≠dos e <strong>sincronizados automaticamente com a nuvem</strong>.</p>
            <div class="modal-actions">
                <button type="button" id="cancel-import-btn" class="btn">Cancelar</button>
                <button type="button" id="confirm-import-btn" class="btn btn-primary">
                    <span class="btn-text">Importar e Salvar</span>
                    <div class="spinner"></div>
                </button>
            </div>
        </div>
    </div>

    <div id="sala-modal" class="modal-backdrop">
        <div class="modal-content" style="max-width: 600px;">
            <h2 id="sala-modal-title" class="view-title">Adicionar Nova Sala</h2>
            <form id="sala-form">
                <input type="hidden" id="sala-id">
                <div class="form-grid" style="grid-template-columns: 1fr 1fr;">
                    <div class="form-group">
                        <label for="sala-nome">Nome da Sala</label>
                        <input type="text" id="sala-nome" placeholder="Ex: SQA20h" required>
                    </div>
                    <div class="form-group">
                        <label for="sala-tipo">Tipo de Turma</label>
                        <select id="sala-tipo" required>
                            <option value="Regular">Regular</option>
                            <option value="Horista">Horista</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="sala-data-inicio">Data de In√≠cio</label>
                        <input type="date" id="sala-data-inicio" required>
                    </div>
                    <div class="form-group">
                        <label for="sala-data-fim">Data Prevista de Fim</label>
                        <input type="date" id="sala-data-fim" required>
                    </div>
                    <div class="form-group full-width">
                        <label>Dias da Semana</label>
                        <div id="sala-dias-semana" class="checkbox-group">
                        </div>
                    </div>
                </div>
                <div id="sala-horista-fields" style="display: none; border-top: 1px solid var(--border-color); margin-top: 1rem; padding-top: 1rem;">
                    <h4 style="color: var(--primary-blue); margin-bottom: 1rem;">Detalhes da Turma Horista</h4>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="sala-escola-horista">Nome da Escola</label>
                            <input type="text" id="sala-escola-horista" placeholder="Ex: Col√©gio ABC">
                        </div>
                        <div class="form-group">
                            <label for="sala-duracao-aula">Dura√ß√£o da Aula (horas)</label>
                            <input type="number" id="sala-duracao-aula" min="0.5" step="0.5" value="2">
                        </div>
                        <div class="form-group full-width">
                            <label for="sala-inicio-livro">In√≠cio do Livro</label>
                            <select id="sala-inicio-livro">
                                <option value="inicio">Come√ßa do In√≠cio</option>
                                <option value="meio">Come√ßa do Meio do Livro</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" id="sala-cancel-btn" class="btn">Cancelar</button>
                    <button type="submit" id="sala-save-btn" class="btn btn-primary">
                        <span class="btn-text">Salvar</span>
                        <div class="spinner"></div>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="finalizar-sala-modal" class="modal-backdrop">
        <div class="modal-content" style="max-width: 500px;">
            <h2 id="finalizar-sala-modal-title" class="view-title">Finalizar Sala</h2>
            <form id="finalizar-sala-form">
                <input type="hidden" id="finalizar-sala-id">
                <p id="finalizar-sala-message" style="margin-bottom: 1.5rem;">Selecione o motivo para finalizar e arquivar esta sala. Ela ser√° movida para a lista de "Salas Finalizadas".</p>
                <div class="form-group">
                    <label for="finalizar-sala-motivo">Motivo da Finaliza√ß√£o</label>
                    <select id="finalizar-sala-motivo" required>
                        <option value="Curso conclu√≠do">Curso conclu√≠do</option>
                        <option value="Troca de professor">Troca de professor</option>
                        <option value="Turma desfeita">Turma desfeita</option>
                        <option value="Outro">Outro</option>
                    </select>
                </div>
                 <div class="form-group" id="finalizar-sala-detalhes-group" style="display: none;">
                    <label for="finalizar-sala-detalhes">Detalhes</label>
                    <textarea id="finalizar-sala-detalhes" placeholder="Forne√ßa mais detalhes sobre o motivo."></textarea>
                </div>
                <div class="modal-actions">
                    <button type="button" id="finalizar-sala-cancel-btn" class="btn">Cancelar</button>
                    <button type="submit" id="finalizar-sala-confirm-btn" class="btn btn-primary">
                        <span class="btn-text">Confirmar Finaliza√ß√£o</span>
                        <div class="spinner"></div>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="livro-modal" class="modal-backdrop">
        <div class="modal-content" style="max-width: 600px;">
            <h2 id="livro-modal-title" class="view-title">Adicionar Novo Livro</h2>
            <form id="livro-form">
                <input type="hidden" id="livro-id">
                <input type="hidden" id="livro-parent-sala-id">
                <div class="form-grid">
                     <div class="form-group full-width">
                        <label for="livro-nome">Nome do Livro</label>
                        <input type="text" id="livro-nome" placeholder="Ex: Book 1" required>
                    </div>
                    <div class="form-group">
                        <label for="livro-mes-inicio">M√™s de In√≠cio</label>
                        <input type="month" id="livro-mes-inicio" required>
                    </div>
                    <div class="form-group">
                        <label for="livro-mes-fim">M√™s Previsto de Fim</label>
                        <input type="month" id="livro-mes-fim" required>
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" id="livro-cancel-btn" class="btn">Cancelar</button>
                    <button type="submit" id="livro-save-btn" class="btn btn-primary">
                        <span class="btn-text">Salvar</span>
                        <div class="spinner"></div>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="aluno-modal" class="modal-backdrop">
        <div class="modal-content" style="max-width: 600px;">
            <h2 id="aluno-modal-title" class="view-title">Adicionar Novo Aluno</h2>
            <form id="aluno-form">
                <input type="hidden" id="aluno-id">
                <input type="hidden" id="aluno-parent-sala-id">
                <input type="hidden" id="aluno-parent-livro-id">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="aluno-ctr">CTR</label>
                        <input type="text" id="aluno-ctr" placeholder="C√≥digo do aluno" required>
                    </div>
                    <div class="form-group">
                        <label for="aluno-nome">Nome Completo</label>
                        <input type="text" id="aluno-nome" placeholder="Nome do aluno" required>
                    </div>
                    <div class="form-group full-width">
                        <label for="aluno-status">Status do Aluno</label>
                        <select id="aluno-status" required>
                            <option value="Ativo">Aluno Novo (Ativo)</option>
                            <option value="Nivelamento">Nivelamento</option>
                            <option value="Transferido (interno)">Transferido (de outra turma)</option>
                            <option value="Transferido (externo)">Transferido (para outra unidade)</option>
                            <option value="Desistente">Desistente / N√£o Frequente</option>
                            <option value="Conclu√≠do">Concluiu o curso</option>
                            <option value="Exclu√≠do">Exclu√≠do</option>
                        </select>
                    </div>
                    <div class="form-group full-width" id="aluno-livro-inicio-group" style="display: none;">
                        <label for="aluno-livro-inicio">Livro de In√≠cio</label>
                        <select id="aluno-livro-inicio"></select>
                    </div>
                    <div class="form-group full-width" id="aluno-origem-group" style="display: none;">
                        <label for="aluno-origem">Origem da Transfer√™ncia</label>
                        <input type="text" id="aluno-origem" placeholder="Ex: SQA19h">
                    </div>
                </div>
                <div id="aluno-historico-group" class="full-width" style="display: none; border-top: 1px solid var(--border-color); margin-top: 1rem; padding-top: 1rem;">
                    <h4 style="color: var(--primary-blue); margin-bottom: 1rem;">Dados de Progresso Anterior</h4>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="aluno-historico-presencas">Aulas que Assistiu (Presen√ßas)</label>
                            <input type="number" id="aluno-historico-presencas" placeholder="Ex: 5" min="0">
                        </div>
                        <div class="form-group">
                            <label for="aluno-historico-aulas-dadas">Total de Aulas Dadas (no Livro)</label>
                            <input type="number" id="aluno-historico-aulas-dadas" placeholder="Ex: 8" min="0">
                        </div>
                    </div>
                    <div class="form-grid" style="grid-template-columns: 1fr 1fr 1fr;">
                        <div class="form-group">
                            <label for="aluno-historico-written">Nota Written</label>
                            <input type="text" inputmode="decimal" id="aluno-historico-written" placeholder="Ex: 8,5">
                        </div>
                        <div class="form-group">
                            <label for="aluno-historico-oral">Nota Oral</label>
                            <input type="text" inputmode="decimal" id="aluno-historico-oral" placeholder="Ex: 9,0">
                        </div>
                        <div class="form-group">
                            <label for="aluno-historico-participation">Nota Participation</label>
                            <input type="text" inputmode="decimal" id="aluno-historico-participation" placeholder="Ex: 10,0">
                        </div>
                    </div>
                </div>
                 <div class="modal-actions">
                    <button type="button" id="aluno-cancel-btn" class="btn">Cancelar</button>
                    <button type="submit" id="aluno-save-btn" class="btn btn-primary">
                        <span class="btn-text">Salvar</span>
                        <div class="spinner"></div>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="transfer-aluno-modal" class="modal-backdrop">
        <div class="modal-content" style="max-width: 600px;">
            <h2 id="transfer-aluno-modal-title" class="view-title">Transferir Aluno</h2>
            <form id="transfer-aluno-form">
                <input type="hidden" id="transfer-source-sala-id">
                <input type="hidden" id="transfer-source-livro-id">
                <div class="form-group">
                    <label for="transfer-aluno-select">Aluno a ser Transferido</label>
                    <select id="transfer-aluno-select" required></select>
                </div>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="transfer-dest-sala-select">Sala de Destino</label>
                        <select id="transfer-dest-sala-select" required></select>
                    </div>
                    <div class="form-group">
                        <label for="transfer-dest-livro-select">Livro de Destino</label>
                        <select id="transfer-dest-livro-select" required></select>
                    </div>
                </div>
                <div id="transfer-grades-group" class="form-group" style="display: none;">
                    <label class="checkbox-group" style="flex-direction: row; align-items: center; gap: 0.5rem; font-weight: 400;">
                        <input type="checkbox" id="transfer-grades-check" style="width: auto;">
                        <span>Manter notas (apenas se o livro for o mesmo. Ex: Book 2 para Book 2)</span>
                    </label>
                </div>
                <div id="transfer-frequency-group" style="border-top: 1px solid var(--border-color); margin-top: 1rem; padding-top: 1rem;">
                    <h4 style="color: var(--primary-blue); margin-bottom: 1rem;">Configura√ß√£o de Frequ√™ncia Inicial</h4>
                    <p style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 1rem;">
                        Defina a base de frequ√™ncia do aluno no novo livro. As chamadas futuras ser√£o somadas a estes valores.
                    </p>
                     <div class="form-grid">
                        <div class="form-group">
                            <label for="transfer-historico-aulas-dadas">Aulas Dadas no Novo Livro</label>
                            <input type="number" id="transfer-historico-aulas-dadas" min="0" value="0" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="transfer-historico-presencas">Presen√ßas Iniciais</label>
                            <input type="number" id="transfer-historico-presencas" min="0" value="0" class="form-control">
                        </div>
                    </div>
                    <button type="button" id="transfer-set-100-freq" class="btn" style="width: 100%; margin-top: 0.5rem;">
                        <span class="btn-text">Dar 100% de Frequ√™ncia (Baseado nas aulas j√° dadas na sala de destino)</span>
                    </button>
                </div>
                <div class="modal-actions">
                    <button type="button" id="transfer-aluno-cancel-btn" class="btn">Cancelar</button>
                    <button type="submit" id="transfer-aluno-save-btn" class="btn btn-primary">
                        <span class="btn-text">Confirmar Transfer√™ncia</span>
                        <div class="spinner"></div>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="aluno-particular-modal" class="modal-backdrop">
        <div class="modal-content" style="max-width: 600px;">
            <h2 id="aluno-particular-modal-title" class="view-title">Adicionar Aluno Particular</h2>
            <form id="aluno-particular-modal-form">
                <input type="hidden" id="aluno-particular-modal-id-input">
                <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                    Voc√™ pode cadastrar um nome novo ou vincular a um aluno j√° existente no sistema para evitar duplicidade.
                </p>
                <div class="form-group">
                    <label for="aluno-particular-modal-nome">Nome do Aluno</label>
                    <input type="text" id="aluno-particular-modal-nome" placeholder="Digite o nome do aluno" required>
                </div>
                <div class="form-group">
                    <label for="aluno-particular-modal-link">Vincular a Aluno Existente (Opcional)</label>
                    <input type="text" id="aluno-particular-modal-link" list="alunos-matriculados-list" placeholder="Comece a digitar para buscar..." autocomplete="off">
                    <datalist id="alunos-matriculados-list">
                    </datalist>
                </div>
                <div class="modal-actions">
                    <button type="button" id="aluno-particular-modal-cancel-btn" class="btn">Cancelar</button>
                    <button type="submit" id="aluno-particular-modal-save-btn" class="btn btn-primary">
                        <span class="btn-text">Salvar</span>
                        <div class="spinner"></div>
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <div id="aula-particular-lesson-modal" class="modal-backdrop">
        <div class="modal-content">
            <h2 id="aula-particular-lesson-modal-title" class="view-title">Registrar Nova Aula</h2>
            <form id="aula-particular-lesson-form">
                <input type="hidden" id="aula-particular-lesson-aluno-id">
                <input type="hidden" id="aula-particular-lesson-id">
                <div class="form-grid" style="grid-template-columns: 1fr 1fr 2fr;">
                    <div class="form-group">
                        <label for="aula-particular-lesson-modal-data">Data</label>
                        <input type="date" id="aula-particular-lesson-modal-data" required>
                    </div>
                    <div class="form-group">
                        <label for="aula-particular-lesson-modal-livro">Livro (Opcional)</label>
                        <input type="text" id="aula-particular-lesson-modal-livro" placeholder="Ex: Book 1">
                    </div>
                    <div class="form-group" style="grid-column: 3 / -1;">
                        <label for="aula-particular-lesson-modal-temas">Temas da Aula</label>
                        <input type="text" id="aula-particular-lesson-modal-temas" placeholder="Ex: Verb to Be, Simple Present" required>
                    </div>
                    <div class="form-group full-width">
                        <label for="aula-particular-lesson-modal-sobras">Conte√∫do para a Pr√≥xima Aula (Opcional)</label>
                        <textarea id="aula-particular-lesson-modal-sobras" style="min-height: 80px;" placeholder="O que n√£o deu tempo de aplicar..."></textarea>
                    </div>
                    <div class="form-group full-width">
                        <label for="aula-particular-lesson-modal-observacoes">Observa√ß√µes (Opcional)</label>
                        <textarea id="aula-particular-lesson-modal-observacoes" style="min-height: 80px;" placeholder="Notas sobre o desempenho do aluno, etc..."></textarea>
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" id="aula-particular-lesson-modal-cancel-btn" class="btn">Cancelar</button>
                    <button type="submit" class="btn btn-primary">
                        <span class="btn-text">Salvar Aula</span>
                        <div class="spinner"></div>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="chamada-modal" class="modal-backdrop">
        <div class="modal-content" style="max-width: 800px;">
            <h2 id="chamada-modal-title" class="view-title">Realizar Chamada</h2>
            <form id="chamada-form">
                <input type="hidden" id="chamada-aula-id">
                <p style="margin-bottom: 1rem; color: var(--text-secondary);">Marque os alunos presentes na aula.</p>
                <div id="chamada-alunos-list">
                </div>
                <div class="modal-actions">
                    <button type="button" id="chamada-cancel-btn" class="btn">Cancelar</button>
                    <button type="submit" id="chamada-save-btn" class="btn btn-primary">
                        <span class="btn-text">Salvar Chamada</span>
                        <div class="spinner"></div>
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <div id="settings-modal" class="modal-backdrop">
        <div class="modal-content" style="max-width: 600px;">
            <h2 class="view-title">Configura√ß√µes Gerais</h2>
            <form id="settings-form">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="setting-teacher-name">Nome do Professor</label>
                        <input type="text" id="setting-teacher-name" required>
                    </div>
                    <div class="form-group">
                        <label for="setting-school-name">Nome da Escola</label>
                        <input type="text" id="setting-school-name" required>
                    </div>
                    <div class="form-group full-width">
                        <label for="setting-school-logo">URL do Logo da Escola (PNG/JPG)</label>
                        <input type="url" id="setting-school-logo" placeholder="https://exemplo.com/logo.png">
                        <small style="color: var(--text-secondary); display: block; margin-top: 0.25rem;">A imagem ser√° ajustada automaticamente para o cabe√ßalho do boletim.</small>
                    </div>
                </div>
                <h3 style="font-size: 1.25rem; font-weight: 600; color: var(--primary-blue); margin: 1.5rem 0 1rem; border-top: 1px solid var(--border-color); padding-top: 1.5rem;">Configura√ß√µes de B√¥nus</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="setting-bonus-value">Valor do B√¥nus por Aluno (R$)</label>
                        <input type="number" id="setting-bonus-value" step="0.01" min="0" required>
                    </div>
                    <div class="form-group">
                        <label for="setting-min-alunos">M√≠nimo de Alunos Frequentes para B√¥nus</label>
                        <input type="number" id="setting-min-alunos" step="1" min="0" required>
                    </div>
                </div>
                <h3 style="font-size: 1.25rem; font-weight: 600; color: var(--primary-blue); margin: 1.5rem 0 1rem; border-top: 1px solid var(--border-color); padding-top: 1.5rem;">Configura√ß√µes de Turmas Horistas</h3>
                <div class="form-grid">
                    <div class="form-group full-width">
                        <label for="setting-valor-hora-aula">Valor da Hora/Aula (R$)</label>
                        <input type="number" id="setting-valor-hora-aula" step="0.01" min="0" required>
                    </div>
                </div>
                <div class="modal-actions" style="justify-content: flex-end;">
                    <div style="display: flex; gap: 0.75rem;">
                        <button type="button" id="settings-cancel-btn" class="btn">Cancelar</button>
                        <button type="submit" id="settings-save-btn" class="btn btn-primary">
                            <span class="btn-text">Salvar Configura√ß√µes</span>
                            <div class="spinner"></div>
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    
    <div id="risco-alunos-modal" class="modal-backdrop">
        <div class="modal-content" style="max-width: 1000px;">
            <h2 id="risco-alunos-modal-title" class="view-title">Alunos em Risco</h2>
            <div id="risco-alunos-table-container">
            </div>
            <div class="modal-actions">
                <button type="button" id="risco-alunos-close-btn" class="btn">Fechar</button>
            </div>
        </div>
    </div>

    <div id="bulk-export-modal" class="modal-backdrop">
        <div class="modal-content" style="max-width: 500px;">
            <h2 class="view-title">Exportar Boletins da Sala</h2>
            <p>Como voc√™ deseja exportar os boletins desta sala?</p>
            <div class="modal-actions" style="justify-content: center; margin-top: 2rem; gap: 1rem;">
                <button type="button" id="export-conjunto-btn" class="btn btn-primary">
                    <span class="btn-text">Arquivo Conjunto (Recomendado)</span>
                    <div class="spinner"></div>
                </button>
                <button type="button" id="export-unicos-btn" class="btn">
                    <span class="btn-text">Arquivos √önicos</span>
                    <div class="spinner"></div>
                </button>
            </div>
            <div style="text-align: center; margin-top: 1rem;">
                 <button type="button" id="bulk-export-cancel-btn" class="btn">Cancelar</button>
            </div>
        </div>
    </div>

    <div id="search-modal" class="modal-backdrop">
        <div class="search-modal-container">
            <button id="search-modal-close-btn" class="btn btn-icon" aria-label="Fechar Pesquisa">
                 <svg class="btn-icon-svg" fill="currentColor" width="24" height="24" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
            </button>
            <input type="search" id="search-modal-input" placeholder="Pesquisar alunos, turmas, livros, conte√∫dos...">
            <div id="search-modal-results">
                <div class="empty-state" style="padding-top: 4rem;">
                    <p>Pesquise por qualquer termo para encontrar o que precisa.</p>
                </div>
            </div>
        </div>
    </div>

    <div id="risk-report-feedback-modal" class="modal-backdrop">
        <div class="modal-content" style="max-width: 700px;">
            <h2 class="view-title">Adicionar Feedback ao Relat√≥rio</h2>
            <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">Este feedback ser√° inclu√≠do no relat√≥rio impresso do aluno. Ambos os campos s√£o opcionais.</p>
            <form id="risk-report-feedback-form">
                <div class="form-group">
                    <label for="risk-feedback-general">Feedback Geral (Comportamentos recorrentes)</label>
                    <textarea id="risk-feedback-general" style="min-height: 100px;"></textarea>
                </div>
                <div class="form-group">
                    <label for="risk-feedback-specific">Feedback Espec√≠fico (Causas das situa√ß√µes de risco)</label>
                    <textarea id="risk-feedback-specific" style="min-height: 100px;"></textarea>
                </div>
                <div class="form-group" id="risk-feedback-default-text-group" style="display: none;">
                    <label class="checkbox-group" style="flex-direction: row; align-items: center; gap: 0.5rem; font-weight: 400;">
                        <input type="checkbox" id="risk-feedback-include-default" style="width: auto;">
                        <span>Incluir sugest√£o de texto padr√£o abaixo do meu feedback</span>
                    </label>
                </div>
                <div class="modal-actions">
                    <button type="button" id="risk-feedback-cancel-btn" class="btn">Cancelar</button>
                    <button type="submit" class="btn btn-primary">
                        <span class="btn-text">Gerar e Imprimir Relat√≥rio</span>
                        <div class="spinner"></div>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- 
      CONT√äINER DE IMPRESS√ÉO
      Esta div oculta √© usada para renderizar conte√∫do espec√≠fico para impress√£o,
      como os boletins. Quando o usu√°rio clica em "Imprimir", o JavaScript
      injeta o HTML do boletim aqui e aciona a fun√ß√£o de impress√£o do navegador.
      As regras de CSS em @media print garantem que apenas este cont√™iner seja impresso.
    -->
    <div id="print-container" aria-hidden="true"></div>

    <div id="bulk-risk-report-modal" class="modal-backdrop">
        <div class="modal-content" style="max-width: 800px;">
            <h2 class="view-title">Selecionar Feedbacks para Relat√≥rio</h2>
            <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">Selecione os pontos de aten√ß√£o que voc√™ deseja incluir no relat√≥rio de risco completo.</p>
            <div class="form-group">
                <label class="checkbox-group" style="flex-direction: row; align-items: center; gap: 0.5rem; font-weight: 500; border-bottom: 1px solid var(--border-color); padding-bottom: 0.75rem; margin-bottom: 0.75rem;">
                    <input type="checkbox" id="bulk-risk-select-all" style="width: auto;">
                    <span>Selecionar Todos / Desmarcar Todos</span>
                </label>
            </div>
            <div id="bulk-risk-selection-list" style="max-height: 50vh; overflow-y: auto; padding-right: 0.5rem; display: flex; flex-direction: column; gap: 0.5rem;">
                <!-- Student and risk checkboxes will be injected here -->
            </div>
            <div class="modal-actions">
                <button type="button" id="cancel-bulk-risk-report-btn" class="btn">Cancelar</button>
                <button type="button" id="confirm-bulk-risk-report-btn" class="btn btn-primary">
                    <span class="btn-text">Gerar e Imprimir Selecionados</span>
                    <div class="spinner"></div>
                </button>
            </div>
        </div>
    </div>

    <!-- 
      CONT√äINER DE NOTIFICA√á√ïES (TOASTS)
      As notifica√ß√µes de feedback (ex: "Salvo com sucesso!") s√£o adicionadas
      dinamicamente a este cont√™iner, que √© posicionado no canto da tela.
      O atributo 'aria-live' √© importante para acessibilidade, informando
      leitores de tela sobre novas mensagens.
    -->
    <div id="toast-container" aria-live="assertive"></div>

    <!-- Rodap√© da Aplica√ß√£o -->
    <footer>
        <p>Vers√£o 3.1. &copy; 2025 Paulo Gabriel de L. S. Todos os direitos reservados.</p>
    </footer>

    <!-- 
      PONTO DE ENTRADA DO JAVASCRIPT
      Este √© o cora√ß√£o da aplica√ß√£o. O atributo 'type="module"' permite o uso de
      importa√ß√µes e exporta√ß√µes ES6 diretamente no navegador. O arquivo 'index.tsx'
      ser√° processado (compilado de TypeScript/JSX) e executado, dando vida √† p√°gina.
    -->
    <script type="module" src="index.tsx"></script>
</body>
</html>
